<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTTPS Traffic</title>
<style>
  .button {
    display: inline-block;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    text-decoration: none;
    color: #fff;
    background-color: #888;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .button:hover {
    background-color: #666;
  }
</style>
</head>
<body>
  <a href="../index.html" class="button">Home</a>
</body>
</html>
<br>
<br>
<br>


<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw);ol{margin:0;padding:0}table td,table th{padding:0}.c5{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c7{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c6{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c0{background-color:#cccccc;font-family:"Consolas";font-weight:400}.c8{color:inherit;text-decoration:inherit}.c4{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c6 doc-content"><p class="c5 title" id="h.q5fnxpbacffj"><span class="c7">Generate, Capture, Analyze and then Decrypt HTTPS traffic</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">HTTPS is an extension of HTTP, but it is used for secure communication. It is just HTTP over TLS. HTTP operates on port 80 while HTTPS operates on port 443.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span>On Wireshark, put in the capture flag </span><span class="c0">port 443</span><span class="c1">&nbsp;and then select the network interface to start the capture. </span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 665.50px; height: 515.63px;"><img alt="" src="images/image8.png" style="width: 665.50px; height: 515.63px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span>To generate some HTTPS traffic enter </span><span class="c3"><a class="c8" href="https://www.google.com/url?q=https://www.google.com&amp;sa=D&amp;source=editors&amp;ust=1710627315844050&amp;usg=AOvVaw2__Xmch6AQPoORnypHI5bm">https://www.google.com</a></span><span class="c1">&nbsp;on a web browser. Then stop the capture.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">A lot of packets are captured. Selected one packet to analyze.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 679.91px; height: 448.61px;"><img alt="" src="images/image10.png" style="width: 679.91px; height: 448.61px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">Here, under the Transport Layer Security expansion, it is telling us that this is HTTP over TLS. And it is also telling us that the application data is encrypted. We won&rsquo;t be able to decrypt these data as we don&rsquo;t have the private key for decryption. That&rsquo;s why it is fully secure. In contrast, in the HTTP session, we observed that we could see all data even the username and password used for authentication. </span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">Although it is really nice that everything is secured and encrypted and we need this whenever we are trying to put our credit card details or some private data anywhere, sometimes we really need to decrypt the encrypted traffic also. For example, when we are trying to administer our network traffic. </span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">We can decrypt the SSL traffic in Wireshark. For this purpose, we can use a very simple way called pre-master secret key where our browser will generate a pre-master secret key and we will log it in an SSL keylog file. Then this key is used by the server which is the webpage or the webserver, to generate a master secret key that encrypts all the traffic. And we have this pre-master secret key logged in a file, we can give it to Wireshark to decrypt the data with it. </span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">First, we need to set an environment variable in Windows so that we can tell the browser to log this pre-master secret key in a certain file. To get the environment variables in Windows: search environment variables &gt; edit the system environment variables &gt; System Properties window &gt; Environment Variables</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 428.90px; height: 403.91px;"><img alt="" src="images/image1.png" style="width: 428.90px; height: 403.91px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span>Now we create a new variable. Variable name should be </span><span class="c0">SSLKEYLOGFILE</span><span class="c1">&nbsp;and the variable value should be the location the key will be logged in.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 515.40px; height: 123.70px;"><img alt="" src="images/image9.png" style="width: 515.40px; height: 123.70px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span>The log file name is given as </span><span class="c0">ssl-keys.log</span><span class="c1">.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">On Wireshark: click Edit &gt; Preferences &gt; expand Protocols &gt; search for TLS</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 618.86px; height: 504.55px;"><img alt="" src="images/image3.png" style="width: 618.86px; height: 504.55px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">Here, we provide Wireshark with the pre-master secret key log file path. </span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span>Now start the capture again on </span><span class="c0">port 443</span><span class="c1">. </span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span>This time, going to a simple website like: </span><span class="c3"><a class="c8" href="https://www.google.com/url?q=https://kbroman.org/simple_site/&amp;sa=D&amp;source=editors&amp;ust=1710627315846599&amp;usg=AOvVaw2W3eLQTnuwyvrcwHKqXmf-">https://kbroman.org/simple_site/</a></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">Then we stop the traffic.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 675.78px; height: 443.59px;"><img alt="" src="images/image4.png" style="width: 675.78px; height: 443.59px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">As we can see, there is a lot of traffic that has happened here. So we go to Statistics &gt; Conversations.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 675.08px; height: 334.77px;"><img alt="" src="images/image5.png" style="width: 675.08px; height: 334.77px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">There are a bunch of conversations that have happened over here. We can ping our webpage to see which one is our target conversation here.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 493.86px; height: 181.55px;"><img alt="" src="images/image6.png" style="width: 493.86px; height: 181.55px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">We can now see the IP address of our target website. Now we can simply search for our target website&rsquo;s IP on the TCP conversations window, and then click on Follow Stream. </span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 635.50px; height: 460.22px;"><img alt="" src="images/image7.png" style="width: 635.50px; height: 460.22px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">As we can see here, all the data is unencrypted.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 683.02px; height: 494.11px;"><img alt="" src="images/image2.png" style="width: 683.02px; height: 494.11px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2"><span class="c1">Also if we analyze the captured packets, it is visible that there are no application data packets from the source anymore. For the first capture, we could see application data packets that were encrypted. For the second capture now there is no application data and we can see everything. We can even extract the source code of the simple site now.</span></p><p class="c2 c4"><span class="c1"></span></p><p class="c2 c4"><span class="c1"></span></p><a href="../index.html" class="button">&lt== Go Back</a></body></html>