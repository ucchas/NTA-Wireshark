<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RADIUS Traffic</title>
<style>
  .button {
    display: inline-block;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    text-decoration: none;
    color: #fff;
    background-color: #888;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .button:hover {
    background-color: #666;
  }
</style>
</head>
<body>
  <a href="../index.html" class="button">Home</a>
</body>
</html>
<br>
<br>
<br>


<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw);ol{margin:0;padding:0}table td,table th{padding:0}.c7{background-color:#cccccc;color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Consolas";font-style:normal}.c6{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c5{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c3{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c8{background-color:#cccccc;font-family:"Consolas";font-weight:400}.c4{color:inherit;text-decoration:inherit}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 doc-content"><p class="c6 title" id="h.ixg8qdj7vyg0"><span class="c9">Generate and capture RADIUS traffic</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Network traffic is either encrypted or unencrypted. Unencrypted protocols like HTTP are referred to as a plain-text or clear-text protocol. One of the simple clear-text protocols is RADIUS.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span>Got one of the public radius servers from this link: </span><span class="c5"><a class="c4" href="https://www.google.com/url?q=https://idblender.com/tools/public-radius&amp;sa=D&amp;source=editors&amp;ust=1710625764271790&amp;usg=AOvVaw35zLKyWkPTjVlBLcfKgXtO">https://idblender.com/tools/public-radius</a></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 641.99px; height: 452.65px;"><img alt="" src="images/image1.png" style="width: 641.99px; height: 452.65px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">RADIUS is a networking protocol that operates on port 1812. RADIUS provides centralized authentication, authorization and accounting management for users who connect and use a network service. RADIUS is a client/server protocol that runs in the application layer.</span></p><p class="c1"><span class="c0"><br>Testing the authentication part and analyze the unencrypted data inside it:</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">The RADIUS server stores the usernames and the passwords and authenticates them when the request comes. Here I set the username and password as shown below and submit.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 499.25px; height: 333.06px;"><img alt="" src="images/image8.png" style="width: 499.25px; height: 333.06px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span>Now to capture the RADIUS traffic, we go back again to Wireshark. This time, we enter the filter first before starting to capture the packets. It is called capture filtering. We use the same when using TCPdump commands. For the RADIUS server the filter shall be </span><span class="c7">port 1812</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.45px; height: 461.85px;"><img alt="" src="images/image3.png" style="width: 624.45px; height: 461.85px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Upon opening the network interface (Ethernet 3), we see nothing as there are no TCP or UDP packets flowing through the port 1812. Now let&rsquo;s send the authentication request to our RADIUS server. </span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">For this step, a tool is used called NTRadPing Test Utility. This is the client part of the RADIUS architecture. This is used to send the authentication request to the public server where the user was created and to receive the response as well. </span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 570.55px; height: 356.28px;"><img alt="" src="images/image2.png" style="width: 570.55px; height: 356.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Here we put the IP as was shown on the RADIUS GUI. The reply time and retries are left as it is and the port is kept as 1812. The RADIUS secret key is left as secret. The username and password is filled out as created before on the GUI. Clicked on send.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 572.53px; height: 358.67px;"><img alt="" src="images/image4.png" style="width: 572.53px; height: 358.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c8">Access-Accept</span><span class="c0">&nbsp;is received as the RADIUS server reply.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span>If we try with an incorrect password, </span><span class="c8">Access-Reject</span><span class="c0">&nbsp;is received as a reply.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Now we go back to Wireshark and click on the red button to stop capturing.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 482.67px;"><img alt="" src="images/image10.png" style="width: 624.00px; height: 482.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span>It is to observe here that RADIUS is unencrypted which is not secure at all. Anyone in the middle can see that there was an authentication happening because </span><span class="c8">Access-Request</span><span class="c0">&nbsp;is seen twice. It is also be seen that the first request was successful and the second one failed. RADIUS by itself provides no encryption of all traffic. If that were a packet encrypted by TLS, we wouldn&rsquo;t know what was being sent.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Let&rsquo;s dig more into the packet. If we go into the first packet and open RADIUS Protocol &gt; Attribute Value Pairs, we can even see the username there. </span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 622.50px; height: 462.21px;"><img alt="" src="images/image6.png" style="width: 622.50px; height: 462.21px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">The only thing we can&rsquo;t see over here is the password. </span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 619.50px; height: 463.15px;"><img alt="" src="images/image9.png" style="width: 619.50px; height: 463.15px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">The field &ldquo;Secret Key&rdquo;, also known as shared secret is used by RADIUS along with the MD5 hashing algorithm to hide the passwords between the server and the client which in itself is a weak protection of the users credentials.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Wireshark can also be used to decrypt these passwords. For this we go to: Edit &gt; Preferences &gt; Protocols &gt; Search for RADIUS</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">The default Shared secret key to encrypt the traffic between NTRadPing and the server was &ldquo;secret&rdquo;. Hence, we now put &ldquo;secret&rdquo; on the prompted field and click OK. </span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 619.40px; height: 447.97px;"><img alt="" src="images/image5.png" style="width: 619.40px; height: 447.97px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">One thing to note here is that the shared secret must be communicated and agreed upon between the server and the client.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 621.30px; height: 461.75px;"><img alt="" src="images/image7.png" style="width: 621.30px; height: 461.75px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Now we can even see the password from the packet details.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1 c2"><span class="c0"></span></p>
  <button onclick="goBack()">Go Back</button>

  <script>
  function goBack() {
    window.history.back();
  }
  </script>
  
</body></html>