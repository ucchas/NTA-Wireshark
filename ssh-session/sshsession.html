<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SSH Session</title>
<style>
  .button {
    display: inline-block;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    text-decoration: none;
    color: #fff;
    background-color: #888;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .button:hover {
    background-color: #666;
  }
</style>
</head>
<body>
  <a href="../index.html" class="button">Home</a>
</body>
</html>
<br>
<br>
<br>


<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw);ol{margin:0;padding:0}table td,table th{padding:0}.c3{background-color:#cccccc;color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Consolas";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c7{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c4{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c5{background-color:#cccccc;font-family:"Consolas";font-weight:400}.c1{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c4 doc-content"><p class="c7 title" id="h.2i4t9hk4eyn7"><span class="c6">Capturing and Analyzing SSH sessions and comparing with Telnet</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Encryption means that data or plain text is encrypted with an encryption algorithm and an encryption key. The process results in cipher text, which only can be viewed in its original form if it is decrypted with the correct key. SSH is the secure form of TELNET. TELNET and SSH are both used to securely manage and access a device. The key difference between them is that SSH uses encryption, which means that all data transmitted over the network is secure and encrypted. Also, Telnet uses port 23 while SSH uses port 22. To secure the communication, SSH uses the security protocol TLS which is the same one as HTTPS. SSL and TLS are sometimes used interchangeably. SSL is the now-deprecated predecessor of TLS and for sure TLS is more secure.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span>To capture the SSH traffic, the same server is used as was created for the Telnet session. Here, instead of capturing only </span><span class="c5">port 22</span><span>&nbsp;traffic for SSH, all the traffic happening between the endpoint device (our machine) and the remote server we will SSH to is to be captured. For this the capture filter shall be </span><span class="c3">host sdf.org</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 671.82px; height: 495.39px;"><img alt="" src="images/image1.png" style="width: 671.82px; height: 495.39px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Double-click the network interface (Ethernet) to start the capture.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span>All of the analysis done in the telnet session is repeated once again this time but with the new </span><span class="c5">host sdf.org</span><span class="c2">&nbsp;capture filter. After repeating the telnet session capture on Wireshark, we can now try to log into the remote machine again but this time with SSH.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 453.50px; height: 130.89px;"><img alt="" src="images/image6.png" style="width: 453.50px; height: 130.89px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span>To connect to the machine with SSH command: </span><span class="c3">ssh username@sdf.org</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">After putting in the password and pressing the backspace key, the following screen is shown:</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 668.81px; height: 399.56px;"><img alt="" src="images/image3.png" style="width: 668.81px; height: 399.56px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">After pressing enter again:</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 679.24px; height: 689.73px;"><img alt="" src="images/image8.png" style="width: 679.24px; height: 689.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 677.24px; height: 331.10px;"><img alt="" src="images/image5.png" style="width: 677.24px; height: 331.10px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Comparing this output from the Telnet session, it is visible that both outputs are the same.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">At this point, the capture is stopped in Wireshark.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">While executing the SSH command, a yes/no question prompt was displayed. It is not an SSH error. It is part of the SSH design to make sure that the connection is secure. Whenever SSH tries to log into a host it hasn&rsquo;t seen before, it pops up a message prompt like this. One can verify the host fingerprint with the intended IP address by comparing it with the fingerprint shown during this verification phase. However, it will not show the same yes/no question prompt if we try to connect again to the same server. This is because it will already have the server address saved on its verified list as the fingerprint has already been confirmed once. </span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">In the packet capture executed this time, there were two conversations with the host machine. One was through Telnet and another was through SSH. Wireshark can also show us both the conversations.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">To see the conversations: Statistics &gt; Conversations</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 677.73px; height: 498.35px;"><img alt="" src="images/image7.png" style="width: 677.73px; height: 498.35px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">As both Telnet and SSH use TCP, the tab to be selected is TCP:</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 678.15px; height: 377.53px;"><img alt="" src="images/image4.png" style="width: 678.15px; height: 377.53px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">As we can see from above, there are 2 TCP conversations that have happened. It shows us that there was a Telnet conversation that happened first on port 23 and then the SSH conversation that happened on port 22. The port numbers, the IP addresses, and all the other relevant information of the conversation are visible on the table.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">To see what Wireshark has captured from the Telnet conversation, first select the port 23 conversation and click on Follow Stream.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 666.04px; height: 707.33px;"><img alt="" src="images/image2.png" style="width: 666.04px; height: 707.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">As observed from the previous Telnet session, everything here is unencrypted. Any man in the middle between me and the server will be able to see everything that has happened in the conversation.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Next, to see what Wireshark has captured from the SSH conversation, select port 22 conversation and then click on follow stream.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 661.31px; height: 695.93px;"><img alt="" src="images/image9.png" style="width: 661.31px; height: 695.93px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">Although the Powershell outputs we got were the same for the SSH and the Telnet, here everything is encrypted. The beginning part here is the negotiation of the key that the server and the client use throughout the conversation, and then after that, everything else is encrypted. Hence, if any man in the middle were to capture this traffic, he wouldn&rsquo;t be able to understand anything and he wouldn&rsquo;t even be able to decrypt this traffic to see what was happening.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0"><span class="c2">In contrast to the Telnet conversation, it is apparent that SSH is an encrypted protocol while Telnet is not.</span></p><p class="c0 c1"><span class="c2"></span></p><p class="c0 c1"><span class="c2"></span></p></body></html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  .button {
    display: inline-block;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    text-decoration: none;
    color: #fff;
    background-color: #888;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .button:hover {
    background-color: #666;
  }
</style>
</head>
<body>
  <a href="../index.html" class="button">&lt== Go Back</a>
</body>
</html>